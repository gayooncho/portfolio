df = read.csv(file = "data_comb.csv")
head(df)

#========================================================
# boxplot을 활용하여 이상치 확인
#========================================================
boxplot(df$police)
boxplot(df$cctv)
boxplot(df$pub)
boxplot(df$oneperson)
boxplot(df$cime)

#========================================================
# 상관관계 확인
#========================================================
# 불필요한 열 제거
#========================================================
df <- subset(df, select = -c(X, District))

#========================================================
# 상관관계 확인
#========================================================
cor(df, method = "pearson")

#========================================================
# 상관관계 시각화 하여 확인
#========================================================
library(PerformanceAnalytics)
chart.Correlation(df, histogram =, pch="+")


#========================================================
# 회귀분석
#========================================================
# vir 다중 공산성에 문제 있는지 확인
#========================================================
install.packages("car")
library(car)
sqrt(vif(noju_lm))

#========================================================
# p-value값 및 계수 확인
#========================================================
summary(lm(formula = df$crime ~ df$cctv + df$police + df$oneperson + df$pub, data = df))

#========================================================
# police 변수가 유의하지 않음
#========================================================



#========================================================
# K-means 군집화
#========================================================

#========================================================
# 유의하지 않은 변수 제거
#========================================================
df <- subset(df,select = -c(police))

#========================================================
# 표준편차 0, 평균1로 표준화
#========================================================
df_scale = scale(df)
head(df_scale)

#========================================================
# NbClust() :  최적의 군집개수를 알려주는 다양한 지표 제공
#========================================================
install.packages("NbClust")
library(NbClust)
set.seed(123)

#========================================================
# 유클리드 거리 / kmeans 군집 / 최소 군집 2개, 최대 군집 10개
#========================================================
nbC <- NbClust(df_scale, distance = "euclidean", method = "kmeans", min.nc = 2, max.nc = 10)

#========================================================
# 최적의 군집개수 확인
#========================================================
nbC$Best.nc
table(nbC$Best.nc[1,])

#========================================================
# 3개 군집으로 분류
#========================================================
clustering_km <- kmeans(df_scale, centers = 3, nstart = 15)
clustering_km$cluster
clustering_km$centers
clustering_km$size

#========================================================
# 군집데이터 시각화
#========================================================
library(cluster)
clusplot(x = df,
        clus = clustering_km$cluster,
        color = TRUE, shade = TRUE,
        labels = 2, lines = 0, main = "Cluster Plot")

